sudo ip addr add 10.0.0.1/32 dev lo  
python3 server.py           
python3 client.py    
sudo python3 attacker.py  

sudo ip addr del 10.0.0.1/32 dev lo








sudo sysctl -w net.ipv4.icmp_ratelimit=0
sudo sysctl -w net.ipv4.conf.all.rp_filter=0
sudo sysctl -w net.ipv4.tcp_retries1=0
sudo sysctl -w net.ipv4.tcp_retries2=0


sudo sysctl -w net.ipv4.ip_forward=1
sudo sysctl -w net.ipv4.conf.all.accept_local=1
sudo sysctl -w net.ipv4.conf.all.route_localnet=1





server,client interface setup:

sudo ip netns add server
sudo ip netns add client

sudo ip link add veth-server type veth peer name veth-client

sudo ip link set veth-server netns server
sudo ip link set veth-client netns client

sudo ip netns exec server ip addr add 10.0.0.1/24 dev veth-server
sudo ip netns exec client ip addr add 10.0.0.2/24 dev veth-client

sudo ip netns exec server ip link set veth-server up
sudo ip netns exec client ip link set veth-client up

sudo ip netns exec server ip link set lo up
sudo ip netns exec client ip link set lo up

sudo ip netns exec client ping 10.0.0.1 -c 3

sudo ip netns exec server python3 server.py
sudo ip netns exec client python3 client.py


















grok cmd:

# Create namespaces
sudo ip netns add server
sudo ip netns add client
sudo ip netns add attacker

# Create veth pairs
sudo ip link add veth-server type veth peer name veth-client
sudo ip link add veth-attacker type veth peer name veth-bridge

# Assign interfaces to namespaces
sudo ip link set veth-server netns server
sudo ip link set veth-client netns client
sudo ip link set veth-attacker netns attacker

# Assign IPs
sudo ip netns exec server ip addr add 10.0.0.1/24 dev veth-server
sudo ip netns exec client ip addr add 10.0.0.2/24 dev veth-client
sudo ip netns exec attacker ip addr add 192.168.1.1/24 dev veth-attacker
sudo ip addr add 192.168.1.2/24 dev veth-bridge

# Enable interfaces
sudo ip netns exec server ip link set veth-server up
sudo ip netns exec client ip link set veth-client up
sudo ip netns exec attacker ip link set veth-attacker up
sudo ip link set veth-bridge up
sudo ip netns exec server ip link set lo up
sudo ip netns exec client ip link set lo up
sudo ip netns exec attacker ip link set lo up





# Enable IP forwarding
sudo sysctl -w net.ipv4.ip_forward=1
sudo ip netns exec server sysctl -w net.ipv4.ip_forward=1
sudo ip netns exec client sysctl -w net.ipv4.ip_forward=1
sudo ip netns exec attacker sysctl -w net.ipv4.ip_forward=1

# Add routes
sudo ip netns exec server ip route add 192.168.1.0/24 dev veth-server
sudo ip netns exec client ip route add 192.168.1.0/24 dev veth-client
sudo ip netns exec attacker ip route add 10.0.0.0/24 dev veth-attacker
sudo ip route add 10.0.0.0/24 dev veth-bridge

for ns in server client attacker; do
    sudo ip netns exec $ns sysctl -w net.ipv4.icmp_ratelimit=0
    sudo ip netns exec $ns sysctl -w net.ipv4.conf.all.rp_filter=0
    sudo ip netns exec $ns sysctl -w net.ipv4.conf.all.accept_local=1
    sudo ip netns exec $ns sysctl -w net.ipv4.conf.all.route_localnet=1
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_retries1=0
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_retries2=0
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_orphan_retries=0
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_rfc1337=0
    sudo ip netns exec $ns sysctl -w net.ipv4.ip_no_pmtu_disc=0
    sudo ip netns exec $ns iptables -F
done

sudo ip netns exec server ip route del 192.168.1.0/24
sudo ip netns exec client ip route del 192.168.1.0/24
sudo ip netns exec attacker ip route del 10.0.0.0/24


# Server: Route to attacker's network via client (which forwards to default namespace)
sudo ip netns exec server ip route add 192.168.1.0/24 via 10.0.0.2 dev veth-server

# Client: Route to attacker's network via default namespace
sudo ip netns exec client ip route add 192.168.1.0/24 via 10.0.0.2 dev veth-client
sudo ip netns exec client ip route add 192.168.1.0/24 dev veth-client

# Attacker: Route to client/server network via default namespace
sudo ip netns exec attacker ip route add 10.0.0.0/24 via 192.168.1.2 dev veth-attacker

# Default namespace: Ensure route to client/server network
sudo ip route add 10.0.0.0/24 dev veth-bridge

sudo sysctl -w net.ipv4.ip_forward=1
sudo ip netns exec server sysctl -w net.ipv4.ip_forward=1
sudo ip netns exec client sysctl -w net.ipv4.ip_forward=1
sudo ip netns exec attacker sysctl -w net.ipv4.ip_forward=1

for ns in server client attacker; do
    sudo ip netns exec $ns sysctl -w net.ipv4.icmp_ratelimit=0
    sudo ip netns exec $ns sysctl -w net.ipv4.conf.all.rp_filter=0
    sudo ip netns exec $ns sysctl -w net.ipv4.conf.all.accept_local=1
    sudo ip netns exec $ns sysctl -w net.ipv4.conf.all.route_localnet=1
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_retries1=0
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_retries2=0
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_orphan_retries=0
    sudo ip netns exec $ns sysctl -w net.ipv4.tcp_rfc1337=0
    sudo ip netns exec $ns sysctl -w net.ipv4.ip_no_pmtu_disc=0
    sudo ip netns exec $ns iptables -F
done
sudo sysctl -w net.ipv4.conf.veth-bridge.rp_filter=0
sudo iptables -F